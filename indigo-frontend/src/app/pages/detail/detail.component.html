<p-toast position="top-center" [showTransformOptions]="'translateY(-100%)'"></p-toast>
<div class="book" *ngIf="selected">
  <p-card>
    <div class="content-header p-grid">
      <div class="p-col-12 p-md-7">
        <span class="page-title">
          {{selected.title}}
        </span>
      </div>
      <div class="p-col-5 book-title-buttons">

        <button id="viewEpub" type="button" pButton (click)="viewEpub();" icon="pi pi-eye"
          title="{{'locale.buttons.view' | translate}}" class="book-title-button"></button>

        <button id="send2Kindle" type="button" pButton (click)="sendToKindle();" icon="pi pi-share-alt"
          title="{{'locale.buttons.send' | translate}}" class="book-title-button" *ngIf="kindle"></button>

        <button id="addFavoriteBook" type="button" pButton (click)="addFavoriteBook();" icon="pi pi-heart"
          title="{{'locale.buttons.favorite.add' | translate}}" class="book-title-button"
          *ngIf="!favoriteBook"></button>

        <button id="deleteFavoriteBook" type="button" pButton (click)="deleteFavoriteBook();" icon="pi pi-heart"
          title="{{'locale.buttons.favorite.delete' | translate}}" class="book-title-button-favorite"
          *ngIf="favoriteBook"></button>
      </div>
    </div>
    <div class="content-body p-grid">
      <div class="p-col-12 p-md-4 p-lg-2 p-xl-1">
        <div class="book-title-image">
          <img [src]="selected.image" class="book-detail-image" />
        </div>
        <div class="book-title-buttons-side">


          <button id="addFavoriteBookSmall" type="button" pButton (click)="addFavoriteBook();" icon="pi pi-heart"
            title="{{'locale.buttons.favorite.add' | translate}}" class="book-title-button"
            *ngIf="!favoriteBook"></button>

          <button id="deleteFavoriteBookSmall" type="button" pButton (click)="deleteFavoriteBook();" icon="pi pi-heart"
            title="{{'locale.buttons.favorite.delete' | translate}}" class="book-title-button-favorite"
            *ngIf="favoriteBook"></button>

          <button id="send2KindleSmall" type="button" pButton (click)="sendToKindle();" icon="pi pi-share-alt"
            title="{{'locale.buttons.send' | translate}}" class="book-title-button" *ngIf="kindle"></button>

          <button id="viewEpub" type="button" pButton (click)="viewEpub();" icon="pi pi-eye"
            title="{{'locale.buttons.view' | translate}}" class="book-title-button"></button>

        </div>

      </div>
      <div class="p-col-12 p-md-8 p-lg-10 p-xl-11">
        <div class="book-detail-subtitle">
          <span *ngFor="let author of selected.authors">
            <a href="javascript:;" (click)="getBooksByAuthor(author);">{{author}}</a><span
              *ngIf="author != selected.authors[selected.authors.length-1]"> & </span>
          </span>
        </div>
        <div *ngIf="selected.rating">
          <p-rating [ngModel]="selected.rating" readonly="true" stars="5" [cancel]="false"></p-rating>
        </div>
        <div>{{'locale.books.detail.pubdate' | translate}} {{selected.pubDate}}</div>
        <div>{{selected.pages}} {{'locale.books.detail.pages' | translate}}</div>
        <div class="book-detail-series" *ngIf="selected.serie && selected.serie.name">
          <button type="button" pButton (click)="getBooksBySerie(selected.serie.name);" [label]="selected.serie.name"
            class="book-detail-serie p-button-info"></button>
          <span class="book-detail-serie-num">{{selected.serie.index}}</span>
        </div>
        <div class="book-detail-tags" *ngIf="selected.tags">
          <button type="button" pButton (click)="getBooksByTag(tag);" [label]="tag"
            class="book-detail-tag p-button-success" *ngFor="let tag of selected.tags"></button>
        </div>


        <div class="book-detail-comment" [innerHTML]="selected.comment"></div>

        <div class="book-detail-buttons">

          <button type="button" pButton label="{{'locale.buttons.close' | translate}}" (click)="close()"
            class="book-detail-button"></button>

        </div>

      </div>
    </div>
  </p-card>

  <p-dialog (onShow)="showDialogMaximized(dialDetail)" #dialDetail [style]="{width: '500px'}" [(visible)]="showEpub"
    [modal]="true" [baseZIndex]="10000" [draggable]="false" [closable]="true" [resizable]="false" [focusOnShow]="false">

    <p-header> {{ selected.title }} </p-header>
    <div class="p-grid">
      <div class="p-col-12 p-md-3">
        <p-card>
          <div class="chapters">
            <div class="ch" *ngFor="let item of chapterList" (click)="changeChapter(item.href)">{{item.label}}</div>
          </div>
        </p-card>
      </div>
      <div class="p-col-12 p-md-9">
        <p-card>
          <div class="test">
            <div id="viewer" class="spreads" #viewer></div>
          </div>
        </p-card>
      </div>
    </div>
    <div class="overlay">
      <div class="options">
        <button (click)="prev()">Previous</button>
        <button (click)="next()">Next</button>
      </div>
    </div>

  </p-dialog>
</div>

<div class="book" *ngIf="similar?.length > 0">
  <p-card>
    <div class="content-header p-grid">
      <div class="p-col-12 p-md-6">
        <span class="page-title">
          {{'locale.books.similar.title' | translate}}
        </span>
      </div>
    </div>
    <div class="content-body p-grid">
      <div class="p-sm-6 p-md-4 p-lg-2 p-xl-1" *ngFor="let book of similar">
        <img [src]="book.image" height="225" class="list-image" (click)="showDetails(book)" style="cursor: pointer;" />
        <div>
          <span class="title">{{book.title}}</span>
        </div>
        <div>
          <span class="subtitle" *ngFor="let author of book.authors">
            <a href="javascript:;" (click)="getBooksByAuthor(author)">{{author}}</a><span
              *ngIf="author != book.authors[book.authors.length-1]"> & </span></span>
        </div>
        <div *ngIf="book.rating">
          <p-rating [ngModel]="book.rating" readonly="true" stars="5" [cancel]="false"></p-rating>
        </div>
      </div>
    </div>
  </p-card>
</div>

<div class="book" *ngIf="recommendations?.length > 0">
  <p-card>
    <div class="content-header p-grid">
      <div class="p-col-12 p-md-6">
        <span class="page-title">
          {{'locale.books.recommendations.title' | translate}}
        </span>
      </div>
    </div>
    <div class="content-body p-grid">
      <div class="p-sm-6 p-md-4 p-lg-2 p-xl-1" *ngFor="let book of recommendations">
        <img [src]="book.image" height="225" class="list-image" (click)="showDetails(book)" style="cursor: pointer;" />
        <div>
          <span class="title">{{book.title}}</span>
        </div>
        <div>
          <span class="subtitle" *ngFor="let author of book.authors">
            <a href="javascript:;" (click)="getBooksByAuthor(author)">{{author}}</a><span
              *ngIf="author != book.authors[book.authors.length-1]"> & </span></span>
        </div>
        <div *ngIf="book.rating">
          <p-rating [ngModel]="book.rating" readonly="true" stars="5" [cancel]="false"></p-rating>
        </div>
      </div>
    </div>
  </p-card>
</div>