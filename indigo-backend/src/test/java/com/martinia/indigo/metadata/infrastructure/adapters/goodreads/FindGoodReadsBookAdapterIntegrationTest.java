package com.martinia.indigo.metadata.infrastructure.adapters.goodreads;

import com.martinia.indigo.BaseIndigoIntegrationTest;
import com.martinia.indigo.BaseIndigoTest;
import com.martinia.indigo.metadata.domain.model.ProviderEnum;
import com.martinia.indigo.metadata.domain.ports.adapters.goodreads.FindGoodReadsBookPort;
import com.martinia.indigo.metadata.domain.ports.usecases.goodreads.FindGoodReadsBookUseCase;
import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.boot.test.mock.mockito.MockBean;

import javax.annotation.Resource;
import java.util.Arrays;
import java.util.List;

import static org.junit.jupiter.api.Assertions.assertArrayEquals;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertNull;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.Mockito.times;
import static org.mockito.Mockito.verify;
import static org.mockito.Mockito.when;

@SpringBootTest
public class FindGoodReadsBookAdapterIntegrationTest extends BaseIndigoIntegrationTest {

	private final String XML = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><GoodreadsResponse><Request><authentication>true</authentication><key><![CDATA[usnvwo0d4PBtqDygTvVUcQ]]></key><method><![CDATA[book_title]]></method></Request><book><id>60182188</id><title>Fulgor (Anhelo, #4)</title><isbn><![CDATA[8408252003]]></isbn><isbn13><![CDATA[9788408252009]]></isbn13><asin><![CDATA[]]></asin><kindle_asin><![CDATA[]]></kindle_asin><marketplace_id><![CDATA[]]></marketplace_id><country_code><![CDATA[RO]]></country_code><image_url>https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1642869777l/60182188._SX98_.jpg</image_url><small_image_url>https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1642869777l/60182188._SY75_.jpg</small_image_url><publication_year>2022</publication_year><publication_month>3</publication_month><publication_day>2</publication_day><publisher>Editorial Planeta</publisher><language_code>spa</language_code><is_ebook>false</is_ebook><description><![CDATA[Nadie sobrevivió ileso a la última batalla. Flint está enfadado con el mundo, Jaxon se está convirtiendo en algo que no reconozco, y Hudson ha levantado un muro que no estoy segura de poder romper.<br /><br />Ahora se acerca una guerra y no estamos listos. Necesitaríamos un ejército para tener alguna esperanza de ganar. Pero antes de eso necesito encontrar respuestas a las incógnitas sobre mis antepasados. Respuestas que podrían revelar quién es el verdadero monstruo entre nosotros… en un mundo lleno de vampiros sedientos de sangre, gárgolas inmortales y una antigua batalla entre dos dioses.<br /><br />No hay garantía de que nadie se quede en pie cuando el polvo se asiente, pero si queremos salvar este mundo, no tengo otra opción. Tendré que abrazar cada parte de mí ... incluso las partes que más temo.]]></description><work><id type=\"integer\">86591084</id><books_count type=\"integer\">34</books_count><best_book_id type=\"integer\">55527921</best_book_id><reviews_count type=\"integer\">157107</reviews_count><ratings_sum type=\"integer\">213591</ratings_sum><ratings_count type=\"integer\">51032</ratings_count><text_reviews_count type=\"integer\">4118</text_reviews_count><original_publication_year type=\"integer\">2022</original_publication_year><original_publication_month type=\"integer\">2</original_publication_month><original_publication_day type=\"integer\">1</original_publication_day><original_title>Court</original_title><original_language_id type=\"integer\" nil=\"true\"/><media_type>book</media_type><rating_dist>5:23055|4:17368|3:8194|2:1847|1:568|total:51032</rating_dist><desc_user_id type=\"integer\">72713545</desc_user_id><default_chaptering_book_id type=\"integer\" nil=\"true\"/><default_description_language_code nil=\"true\"/><work_uri>kca://work/amzn1.gr.work.v3.06bImPGU4rjnBY1V</work_uri></work><average_rating>4.19</average_rating><num_pages><![CDATA[958]]></num_pages><format><![CDATA[Paperback]]></format><edition_information><![CDATA[]]></edition_information><ratings_count><![CDATA[4809]]></ratings_count><text_reviews_count><![CDATA[739]]></text_reviews_count><url><![CDATA[https://www.goodreads.com/book/show/60182188-fulgor]]></url><link><![CDATA[https://www.goodreads.com/book/show/60182188-fulgor]]></link><authors><author><id>2003596</id><name>Tracy Wolff</name><role></role><image_url nophoto='false'><![CDATA[https://images.gr-assets.com/authors/1596045458p5/2003596.jpg]]></image_url><small_image_url nophoto='false'><![CDATA[https://images.gr-assets.com/authors/1596045458p2/2003596.jpg]]></small_image_url><link><![CDATA[https://www.goodreads.com/author/show/2003596.Tracy_Wolff]]></link><average_rating>4.04</average_rating><ratings_count>532722</ratings_count><text_reviews_count>56092</text_reviews_count></author></authors><reviews_widget><![CDATA[<style>#goodreads-widget {font-family: georgia, serif;padding: 18px 0;width:565px;}#goodreads-widget h1 {font-weight:normal;font-size: 16px;border-bottom: 1px solid #BBB596;margin-bottom: 0;}#goodreads-widget a {text-decoration: none;color:#660;}iframe{background-color: #fff;}#goodreads-widget a:hover { text-decoration: underline; }#goodreads-widget a:active {color:#660;}#gr_footer {width: 100%;border-top: 1px solid #BBB596;text-align: right;}#goodreads-widget .gr_branding{color: #382110;font-size: 11px;text-decoration: none;font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif;}</style><div id=\"goodreads-widget\"><div id=\"gr_header\"><h1><a rel=\"nofollow\" href=\"https://www.goodreads.com/book/show/60182188-fulgor\">Fulgor Reviews</a></h1></div><iframe sandbox id=\"the_iframe\" src=\"https://www.goodreads.com/api/reviews_widget_iframe?did=DEVELOPER_ID&amp;format=html&amp;isbn=8408252003&amp;links=660&amp;min_rating=&amp;review_back=fff&amp;stars=000&amp;text=000\" width=\"565\" height=\"400\" frameborder=\"0\"></iframe><div id=\"gr_footer\"><a class=\"gr_branding\" target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.goodreads.com/book/show/60182188-fulgor?utm_medium=api&amp;utm_source=reviews_widget\">Reviews from Goodreads.com</a></div></div>]]></reviews_widget><popular_shelves><shelf name=\"to-read\" count=\"71806\"/><shelf name=\"currently-reading\" count=\"9497\"/><shelf name=\"fantasy\" count=\"748\"/><shelf name=\"physical-tbr\" count=\"293\"/><shelf name=\"romance\" count=\"268\"/><shelf name=\"tbr\" count=\"241\"/><shelf name=\"books-i-own\" count=\"211\"/><shelf name=\"young-adult\" count=\"209\"/><shelf name=\"owned\" count=\"181\"/><shelf name=\"series\" count=\"168\"/><shelf name=\"paranormal\" count=\"163\"/><shelf name=\"dnf\" count=\"159\"/><shelf name=\"favorites\" count=\"159\"/><shelf name=\"vampires\" count=\"150\"/><shelf name=\"ya\" count=\"138\"/><shelf name=\"crave\" count=\"136\"/><shelf name=\"audiobook\" count=\"123\"/><shelf name=\"audiobooks\" count=\"121\"/><shelf name=\"sub\" count=\"93\"/><shelf name=\"want-to-buy\" count=\"83\"/><shelf name=\"2022-reads\" count=\"83\"/><shelf name=\"kindle\" count=\"80\"/><shelf name=\"fiction\" count=\"79\"/><shelf name=\"to-buy\" count=\"71\"/><shelf name=\"read-in-2022\" count=\"70\"/><shelf name=\"crave-series\" count=\"68\"/><shelf name=\"read-2022\" count=\"65\"/><shelf name=\"kindle-unlimited\" count=\"64\"/><shelf name=\"library\" count=\"63\"/><shelf name=\"tracy-wolff\" count=\"62\"/><shelf name=\"vampire\" count=\"60\"/><shelf name=\"2023-reads\" count=\"60\"/><shelf name=\"fantasía\" count=\"59\"/><shelf name=\"read-2023\" count=\"57\"/><shelf name=\"my-library\" count=\"55\"/><shelf name=\"ya-fantasy\" count=\"55\"/><shelf name=\"read-in-2023\" count=\"54\"/><shelf name=\"2022-releases\" count=\"53\"/><shelf name=\"need-to-buy\" count=\"52\"/><shelf name=\"audio\" count=\"50\"/><shelf name=\"supernatural\" count=\"49\"/><shelf name=\"2022-books\" count=\"48\"/><shelf name=\"fantasia\" count=\"47\"/><shelf name=\"2023-books\" count=\"43\"/><shelf name=\"bookshelf\" count=\"43\"/><shelf name=\"owned-books\" count=\"40\"/><shelf name=\"magic\" count=\"40\"/><shelf name=\"fantasy-romance\" count=\"39\"/><shelf name=\"romantasy\" count=\"38\"/><shelf name=\"ebook\" count=\"36\"/><shelf name=\"paranormal-romance\" count=\"35\"/><shelf name=\"owned-tbr\" count=\"34\"/><shelf name=\"my-books\" count=\"33\"/><shelf name=\"wish-list\" count=\"32\"/><shelf name=\"did-not-finish\" count=\"31\"/><shelf name=\"books-i-have\" count=\"31\"/><shelf name=\"witches\" count=\"31\"/><shelf name=\"audible\" count=\"31\"/><shelf name=\"my-bookshelf\" count=\"30\"/><shelf name=\"audio-books\" count=\"29\"/><shelf name=\"on-my-shelf\" count=\"28\"/><shelf name=\"2023-read\" count=\"27\"/><shelf name=\"2022-read\" count=\"27\"/><shelf name=\"to-be-read\" count=\"27\"/><shelf name=\"bought\" count=\"26\"/><shelf name=\"dragons\" count=\"26\"/><shelf name=\"ebooks\" count=\"26\"/><shelf name=\"saga-crave\" count=\"24\"/><shelf name=\"werewolves\" count=\"24\"/><shelf name=\"books-to-buy\" count=\"23\"/><shelf name=\"pendientes\" count=\"22\"/><shelf name=\"buy\" count=\"22\"/><shelf name=\"kindle-tbr\" count=\"21\"/><shelf name=\"physical-books\" count=\"21\"/><shelf name=\"physical\" count=\"21\"/><shelf name=\"urban-fantasy\" count=\"21\"/><shelf name=\"have\" count=\"19\"/><shelf name=\"on-my-bookshelf\" count=\"19\"/><shelf name=\"5-stars\" count=\"19\"/><shelf name=\"series-to-finish\" count=\"19\"/><shelf name=\"home-library\" count=\"17\"/><shelf name=\"physical-library\" count=\"17\"/><shelf name=\"comprar\" count=\"17\"/><shelf name=\"audio-book\" count=\"17\"/><shelf name=\"2021-releases\" count=\"17\"/><shelf name=\"2023-tbr\" count=\"16\"/><shelf name=\"personal-library\" count=\"16\"/><shelf name=\"fantasy-tbr\" count=\"16\"/><shelf name=\"sequels\" count=\"16\"/><shelf name=\"2024-tbr\" count=\"15\"/><shelf name=\"libby\" count=\"15\"/><shelf name=\"2022-books-read\" count=\"15\"/><shelf name=\"ya-romance\" count=\"15\"/><shelf name=\"tbr-fantasy\" count=\"15\"/><shelf name=\"favourites\" count=\"15\"/><shelf name=\"fated-mates\" count=\"14\"/><shelf name=\"teen\" count=\"14\"/><shelf name=\"favs\" count=\"14\"/><shelf name=\"sagas\" count=\"14\"/><shelf name=\"vampiros\" count=\"14\"/></popular_shelves><book_links><book_link><id>8</id><name>Libraries</name><link>https://www.goodreads.com/book_link/follow/8</link></book_link></book_links><buy_links><buy_link><id>1</id><name>Amazon</name><link>https://www.goodreads.com/book_link/follow/1</link></buy_link><buy_link><id>10</id><name>Audible</name><link>https://www.goodreads.com/book_link/follow/10</link></buy_link><buy_link><id>3</id><name>Barnes &amp; Noble</name><link>https://www.goodreads.com/book_link/follow/3</link></buy_link><buy_link><id>4</id><name>AbeBooks</name><link>https://www.goodreads.com/book_link/follow/4</link></buy_link><buy_link><id>1027</id><name>Walmart eBooks</name><link>https://www.goodreads.com/book_link/follow/1027</link></buy_link><buy_link><id>2102</id><name>Apple Books</name><link>https://www.goodreads.com/book_link/follow/2102</link></buy_link><buy_link><id>8036</id><name>Google Play</name><link>https://www.goodreads.com/book_link/follow/8036</link></buy_link><buy_link><id>5</id><name>Alibris</name><link>https://www.goodreads.com/book_link/follow/5</link></buy_link><buy_link><id>9</id><name>Indigo</name><link>https://www.goodreads.com/book_link/follow/9</link></buy_link><buy_link><id>107</id><name>Better World Books</name><link>https://www.goodreads.com/book_link/follow/107</link></buy_link><buy_link><id>7</id><name>IndieBound</name><link>https://www.goodreads.com/book_link/follow/7</link></buy_link><buy_link><id>92</id><name>Thriftbooks</name><link>https://www.goodreads.com/book_link/follow/92</link></buy_link></buy_links><series_works><series_work><id>1687078</id><user_position>4</user_position><series><id>286781</id><title><![CDATA[Crave]]></title><description><![CDATA[Spin-off: <a href=\"https://www.goodreads.com/series/365652-the-calder-academy\">The Calder Academy series</a>.]]></description><note><![CDATA[]]></note><series_works_count>17</series_works_count><primary_work_count>6</primary_work_count><numbered>true</numbered></series></series_work></series_works><similar_books><book><id>22458745</id><uri><![CDATA[kca://book/amzn1.gr.book.v1.1cYx6kyTqSwbLRWT49QXgw]]></uri><title>Guardian (The Guardian #1)</title><title_without_series>Guardian</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/22458745-guardian]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1402545502l/22458745._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1402545502l/22458745._SX98_.jpg]]></image_url><num_pages>242</num_pages><work><id>41892991</id></work><isbn>1311439242</isbn><isbn13>9781311439246</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2014</publication_year><publication_month>5</publication_month><publication_day>18</publication_day><authors><author><id>8302089</id><name>A.J. Messenger</name><link><![CDATA[https://www.goodreads.com/author/show/8302089.A_J_Messenger]]></link></author></authors></book><book><id>90202302</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.RH2MLDOsN7Jgh9eg]]></uri><title>Iron Flame (The Empyrean, #2)</title><title_without_series>Iron Flame</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/90202302-iron-flame]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1687463048l/90202302._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1687463048l/90202302._SX98_.jpg]]></image_url><num_pages>624</num_pages><work><id>114498467</id></work><isbn>1649374178</isbn><isbn13>9781649374172</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year></publication_year><publication_month></publication_month><publication_day></publication_day><authors><author><id>7539785</id><name>Rebecca Yarros</name><link><![CDATA[https://www.goodreads.com/author/show/7539785.Rebecca_Yarros]]></link></author></authors></book><book><id>30973483</id><uri><![CDATA[kca://book/amzn1.gr.book.v1.UMLyZ15fnwa13Fz1GmDgrQ]]></uri><title>Fallen (The Guardian #2)</title><title_without_series>Fallen</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/30973483-fallen]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1468007383l/30973483._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1468007383l/30973483._SX98_.jpg]]></image_url><num_pages>222</num_pages><work><id>51591557</id></work><isbn></isbn><isbn13></isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2016</publication_year><publication_month>7</publication_month><publication_day>8</publication_day><authors><author><id>8302089</id><name>A.J. Messenger</name><link><![CDATA[https://www.goodreads.com/author/show/8302089.A_J_Messenger]]></link></author></authors></book><book><id>61431922</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.FxNvB1y9g8vJqQ8p]]></uri><title><![CDATA[Fourth Wing (The Empyrean, #1)]]></title><title_without_series>Fourth Wing</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/61431922-fourth-wing]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1701980900l/61431922._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1701980900l/61431922._SX98_.jpg]]></image_url><num_pages>498</num_pages><work><id>96945623</id></work><isbn>1649374046</isbn><isbn13>9781649374042</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2023</publication_year><publication_month>5</publication_month><publication_day>2</publication_day><authors><author><id>7539785</id><name>Rebecca Yarros</name><link><![CDATA[https://www.goodreads.com/author/show/7539785.Rebecca_Yarros]]></link></author></authors></book><book><id>31679555</id><uri><![CDATA[kca://book/amzn1.gr.book.v1.Of_DpbsWWuUe0Yv2_ujHXA]]></uri><title>Revelation (The Guardian #3)</title><title_without_series>Revelation</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/31679555-revelation]]></link><small_image_url><![CDATA[https://s.gr-assets.com/assets/nophoto/book/50x75-a91bf249278a81aabab721ef782c4a74.png]]></small_image_url><image_url><![CDATA[https://s.gr-assets.com/assets/nophoto/book/111x148-bcc042a9c91a29c1d680899eff700a03.png]]></image_url><num_pages></num_pages><work><id>52350316</id></work><isbn></isbn><isbn13></isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year></publication_year><publication_month></publication_month><publication_day></publication_day><authors><author><id>8302089</id><name>A.J. Messenger</name><link><![CDATA[https://www.goodreads.com/author/show/8302089.A_J_Messenger]]></link></author></authors></book><book><id>42865872</id><uri><![CDATA[kca://book/amzn1.gr.book.v1.h2KSj2elTEH0LEnP4qvA3w]]></uri><title>Return (The Guardian #4)</title><title_without_series>Return</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/42865872-return]]></link><small_image_url><![CDATA[https://s.gr-assets.com/assets/nophoto/book/50x75-a91bf249278a81aabab721ef782c4a74.png]]></small_image_url><image_url><![CDATA[https://s.gr-assets.com/assets/nophoto/book/111x148-bcc042a9c91a29c1d680899eff700a03.png]]></image_url><num_pages></num_pages><work><id>66649530</id></work><isbn></isbn><isbn13></isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year></publication_year><publication_month></publication_month><publication_day></publication_day><authors><author><id>8302089</id><name>A.J. Messenger</name><link><![CDATA[https://www.goodreads.com/author/show/8302089.A_J_Messenger]]></link></author></authors></book><book><id>57815107</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.DTnY8u-Dj7KAwoOO]]></uri><title><![CDATA[The War of Two Queens (Blood and Ash, #4)]]></title><title_without_series>The War of Two Queens</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/57815107-the-war-of-two-queens]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1635174962l/57815107._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1635174962l/57815107._SX98_.jpg]]></image_url><num_pages>628</num_pages><work><id>90566101</id></work><isbn></isbn><isbn13>9781952457722</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2022</publication_year><publication_month>3</publication_month><publication_day>15</publication_day><authors><author><id>4476934</id><name>Jennifer L. Armentrout</name><link><![CDATA[https://www.goodreads.com/author/show/4476934.Jennifer_L_Armentrout]]></link></author></authors></book><book><id>63847274</id><uri><![CDATA[kca://book/amzn1.gr.book.v3._3A8HXZhWKpySDqv]]></uri><title><![CDATA[A Soul of Ash and Blood (Blood and Ash, #5)]]></title><title_without_series>A Soul of Ash and Blood</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/63847274-a-soul-of-ash-and-blood]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1677612497l/63847274._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1677612497l/63847274._SX98_.jpg]]></image_url><num_pages></num_pages><work><id>99805803</id></work><isbn>1957568461</isbn><isbn13>9781957568461</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2023</publication_year><publication_month>7</publication_month><publication_day>18</publication_day><authors><author><id>4476934</id><name>Jennifer L. Armentrout</name><link><![CDATA[https://www.goodreads.com/author/show/4476934.Jennifer_L_Armentrout]]></link></author></authors></book><book><id>58470171</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.4DOwZTLoVVt36HiG]]></uri><title><![CDATA[Kingdom of the Feared (Kingdom of the Wicked, #3)]]></title><title_without_series>Kingdom of the Feared</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/58470171-kingdom-of-the-feared]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1644386147l/58470171._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1644386147l/58470171._SX98_.jpg]]></image_url><num_pages>464</num_pages><work><id>91793740</id></work><isbn>0316342084</isbn><isbn13>9780316342087</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2022</publication_year><publication_month>9</publication_month><publication_day>27</publication_day><authors><author><id>14584166</id><name>Kerri Maniscalco</name><link><![CDATA[https://www.goodreads.com/author/show/14584166.Kerri_Maniscalco]]></link></author></authors></book><book><id>58545703</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.P4PBELILaoo4-jMc]]></uri><title>Hooked (Never After, #1)</title><title_without_series>Hooked</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/58545703-hooked]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1629119366l/58545703._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1629119366l/58545703._SX98_.jpg]]></image_url><num_pages>312</num_pages><work><id>92003062</id></work><isbn>173750832X</isbn><isbn13></isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2021</publication_year><publication_month>9</publication_month><publication_day>7</publication_day><authors><author><id>20245445</id><name>Emily McIntire</name><link><![CDATA[https://www.goodreads.com/author/show/20245445.Emily_McIntire]]></link></author></authors></book><book><id>60784546</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.ykonNUZNNpYC2MoI]]></uri><title><![CDATA[Divine Rivals (Letters of Enchantment, #1)]]></title><title_without_series>Divine Rivals</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/60784546-divine-rivals]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1655928079l/60784546._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1655928079l/60784546._SX98_.jpg]]></image_url><num_pages>357</num_pages><work><id>94100483</id></work><isbn>1250857430</isbn><isbn13>9781250857439</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year></publication_year><publication_month></publication_month><publication_day></publication_day><authors><author><id>14926516</id><name>Rebecca   Ross</name><link><![CDATA[https://www.goodreads.com/author/show/14926516.Rebecca_Ross]]></link></author></authors></book><book><id>58311939</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.2lDvduizORY7Hj7S]]></uri><title><![CDATA[These Twisted Bonds (These Hollow Vows, #2)]]></title><title_without_series>These Twisted Bonds</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/58311939-these-twisted-bonds]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1638258882l/58311939._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1638258882l/58311939._SX98_.jpg]]></image_url><num_pages>481</num_pages><work><id>91424080</id></work><isbn>0358386586</isbn><isbn13>9780358386582</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year></publication_year><publication_month></publication_month><publication_day></publication_day><authors><author><id>2856947</id><name>Lexi Ryan</name><link><![CDATA[https://www.goodreads.com/author/show/2856947.Lexi_Ryan]]></link></author></authors></book><book><id>172133046</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.DJ4TssdM63qVoIJV]]></uri><title><![CDATA[A Light in the Flame (Flesh and Fire, #2)]]></title><title_without_series>A Light in the Flame</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/172133046-a-light-in-the-flame]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1685797258l/172133046._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1685797258l/172133046._SX98_.jpg]]></image_url><num_pages>615</num_pages><work><id>93644210</id></work><isbn>195756816X</isbn><isbn13>9781957568164</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2022</publication_year><publication_month>11</publication_month><publication_day>15</publication_day><authors><author><id>4476934</id><name>Jennifer L. Armentrout</name><link><![CDATA[https://www.goodreads.com/author/show/4476934.Jennifer_L_Armentrout]]></link></author></authors></book><book><id>69333269</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.ci9SDRZhuoDfmsv5]]></uri><title>El arte de ser nosotros</title><title_without_series>El arte de ser nosotros</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/69333269-el-arte-de-ser-nosotros]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1671293653l/69333269._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1671293653l/69333269._SX98_.jpg]]></image_url><num_pages>552</num_pages><work><id>95173989</id></work><isbn>8408267922</isbn><isbn13>9788408267928</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2023</publication_year><publication_month>2</publication_month><publication_day>8</publication_day><authors><author><id>19124696</id><name>Inma Rubiales</name><link><![CDATA[https://www.goodreads.com/author/show/19124696.Inma_Rubiales]]></link></author></authors></book><book><id>199017389</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.8ZFzxKN9SUeNv0Dq]]></uri><title>Black (Wings, #2)</title><title_without_series>Black</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/199017389-black]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1695075925l/199017389._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1695075925l/199017389._SX98_.jpg]]></image_url><num_pages>444</num_pages><work><id>57157822</id></work><isbn></isbn><isbn13></isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2021</publication_year><publication_month>3</publication_month><publication_day></publication_day><authors><author><id>16604778</id><name>Angelina J. Steffort</name><link><![CDATA[https://www.goodreads.com/author/show/16604778.Angelina_J_Steffort]]></link></author></authors></book><book><id>56652074</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.lAEcz7XaeRD62iRu]]></uri><title><![CDATA[Queen of Myth and Monsters (Adrian X Isolde, #2)]]></title><title_without_series>Queen of Myth and Monsters</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/56652074-queen-of-myth-and-monsters]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1646123208l/56652074._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1646123208l/56652074._SX98_.jpg]]></image_url><num_pages>432</num_pages><work><id>88527618</id></work><isbn></isbn><isbn13>9781728259666</isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2022</publication_year><publication_month>12</publication_month><publication_day>20</publication_day><authors><author><id>18145334</id><name>Scarlett St.  Clair</name><link><![CDATA[https://www.goodreads.com/author/show/18145334.Scarlett_St_Clair]]></link></author></authors></book><book><id>199017328</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.sz2R18pY6s3P0nIm]]></uri><title>White (Wings, #1)</title><title_without_series>White</title_without_series><link><![CDATA[https://www.goodreads.com/book/show/199017328-white]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1695075396l/199017328._SY75_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1695075396l/199017328._SX98_.jpg]]></image_url><num_pages>415</num_pages><work><id>55816816</id></work><isbn></isbn><isbn13></isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2021</publication_year><publication_month>3</publication_month><publication_day></publication_day><authors><author><id>16604778</id><name>Angelina J. Steffort</name><link><![CDATA[https://www.goodreads.com/author/show/16604778.Angelina_J_Steffort]]></link></author></authors></book><book><id>60714999</id><uri><![CDATA[kca://book/amzn1.gr.book.v3.RxKi00DA1Je7y6Ux]]></uri><title><![CDATA[The Serpent and the Wings of Night (Crowns of Nyaxia, #1)]]></title><title_without_series><![CDATA[The Serpent and the Wings of Night]]></title_without_series><link><![CDATA[https://www.goodreads.com/book/show/60714999-the-serpent-and-the-wings-of-night]]></link><small_image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1648567430l/60714999._SX50_.jpg]]></small_image_url><image_url><![CDATA[https://i.gr-assets.com/images/S/compressed.photo.goodreads.com/books/1648567430l/60714999._SX98_.jpg]]></image_url><num_pages>504</num_pages><work><id>95720800</id></work><isbn></isbn><isbn13></isbn13><average_rating>4.19</average_rating><ratings_count>51032</ratings_count><publication_year>2022</publication_year><publication_month>8</publication_month><publication_day>30</publication_day><authors><author><id>16170636</id><name>Carissa Broadbent</name><link><![CDATA[https://www.goodreads.com/author/show/16170636.Carissa_Broadbent]]></link></author></authors></book></similar_books></book></GoodreadsResponse>";

	@Resource
	private FindGoodReadsBookPort findGoodReadsBookPort;

	@Test
	public void testFindBook_Successful() {
		// Given
		String key = "example_key";
		String title = "Fulgor";
		List<String> authors = Arrays.asList("Wolff, Tracy");
		boolean withAuthor = true;

		when(dataUtils.getData(anyString())).thenReturn(XML);


		// When
		String[] result = findGoodReadsBookPort.findBook(key, title, authors, withAuthor);

		// Then
		assertEquals("4.19", result[0]);
		assertNotNull(result[1]);
		assertEquals(ProviderEnum.GOODREADS.name(), result[2]);


	}
}